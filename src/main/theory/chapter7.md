# 7. 병렬 데이터 처리와 성능
## 병렬 스트림이란?
* **병렬 스트림(parallel stream)** 은  
  자바 스트림 API에서 **데이터를 여러 스레드로 나누어 동시에 처리**할 수 있도록 만든 스트림이다.
* 스트림 자체는 병렬이 아님! 선언형으로 생겼을 뿐!

```text
list.parallelStream()
    .filter(x -> x > 10)
    .map(x -> x * 2)
    .sum();
```
* 내부적으로 Fork/Join 프레임워크 사용
* 개발자는 스레드 관리 ❌, 로직만 작성 ⭕ 
* 기본 스레드 수는 CPU 코어 개수 기준 
* 즉 “하나의 큰 작업을 여러 CPU 코어가 나눠서 처리하는 방식”

**<언제 병렬 스트림인가?>** 
1. 처리하고자 하는 데이터의 양이 많고, 처리 방법이 CPU 연산 중심일때
   * CPU 연산 중심의 예시) 계산, 암호화, 영상처리 등등
   * CPU 연산이 중심적이지 않은 경우) 파일 읽기, DB 조회, 네트워크
2. 여러 쓰레드가 같은 변수를 건드리지 않아도 될 때
3. 처리 결과 상 순서가 중요하지 않을 때

## 병렬 스트림의 생성
### 스트림 성능 측정
* 스트림이 얼마나 빠른지 한번 실제로 측정을 해보자!
* 벤치마크 도구로 JMH(Java Microbenchmark Harness), 빌드도구로는 Gradle을 사용
  * 책에서는 Maven을 사용했지만, Gradle로 변경
  * JMH란? OpenJDK 팀이 직접 만든 공식 마이크로벤치마크 도구
  * 워밍업 자동 수행, JIT 최적화, 병렬 환경을 통해 해결해줌